



Network Working Group                                       M. Boucadair
Internet-Draft                                                    Orange
Intended status: Standards Track                                T. Reddy
Expires: 27 September 2024                                         Nokia
                                                                 D. Wing
                                                    Cloud Software Group
                                                           26 March 2024


Discovery of Network Rate-Limit Policies Using Router Advertisements and
                                  DHCP
               draft-brw-ac-rate-policy-discovery-latest

Abstract

   Traffic exchanged over an attachment circuit may be subject to rate
   limit policies.  These policies may be intentional policies (e.g.,
   enforced as part of the activation of the attachment circuit) or be
   reactive policies (e.g., enforced temporarily to manage an overload
   or during a DDoS attack mitigation).

   Networks already support mechanisms to advertize a set of network
   properties to hosts using Neighbor Discovery options.  Examples of
   such properties are link MTU (RFC 4861) and PREFIX64 (RFC 8781).
   This document complements these tools and specifies a Neighbor
   Discovery option to be used in Router Advertisements (RAs) to
   communicate these policies to hosts.  For address family parity, a
   new DHCP option is also defined.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Source for this draft and an issue tracker can be found at
   https://github.com/boucadair/draft-xxx-ac-rate-policy-discovery.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 27 September 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
     1.1.  Context
     1.2.  Networks Are Already Sharing Network Properties with Hosts
     1.3.  What's In?
     1.4.  Design Motivation & Rationale
     1.5.  What's Out?
     1.6.  Sample Deployment Cases
   2.  Conventions and Definitions
   3.  NRLP Blob
   4.  IPv6 RA NRLP Option
     4.1.  Option Format
     4.2.  IPv6 Host Behavior
   5.  DHCP NRLP Option
     5.1.  Option Format
     5.2.  DHCPv4 Client Behavior
   6.  Operational Considerations
   7.  Security Considerations
     7.1.  ND
     7.2.  DHCP
   8.  IANA Considerations
     8.1.  Neighbor Discovery Option
     8.2.  DHCP Option
   9.  References
     9.1.  Normative References
     9.2.  Informative References
   Acknowledgments
   Authors' Addresses

1.  Introduction

1.1.  Context

   Connectivity services are provided by networks to customers via
   dedicated terminating points, such as customer edges (CEs) or User
   Equipment (UE) (see Figure 1).  To facilitate data transfer via the
   provider network, it is assumed that appropriate setup is provisioned
   over the links that connect customer terminating points and a
   provider network (usually via a Provider Edge (PE)), allowing
   successfully data exchange over these links.  The required setup is
   referred to in this document as Attachment Circuits (ACs), while the
   underlying link is referred to as "bearers".

   The bearer can be a physical or logical link that connects a customer
   device to a provider network.  A bearer can be a wireless or wired
   link.

       .-------.                .--------------------.         .-------.
       |       +------+         |                    +---AC----+       |
       | UE#1  |      |         |                    +---AC----+ CE#2  |
       '-------'      +---AC----+                    |         '-------'
                                |     Network        |
       .-------.      .---AC----+                    |
       |       |      |         |                    |         .-------.
       | CE#1  +------'         |                    +---AC----+ CE#3  |
       '-------'                |                    |         '----+--'
          /|\                   '-----------+--------'              |
         O O O                              |                       |
         Hosts                              '-----------AC----------'

                   Figure 1: Sample Attachment Circuits

   Customer terminating points are provided with a set of information
   (e.g., IP address/prefix) to successfully be able to send and receive
   traffic over an attachment circuit.  A comprehensive list of
   provisioning parameters that are available on the PE-side of an
   attachment circuit is documented in
   [I-D.ietf-opsawg-ntw-attachment-circuit].

   The required set of parameters is a function of the service offering.
   For example, a very limited set of parameters is required for mass-
   market service offering while a more elaborated set is required for
   Enterprise services (e.g., Layer 2 or Layer 3 VPN services).  This
   document *leverages access control, authorization, and authentication
   mechanisms that are already in place for the delivery of services
   over these attachment circuits*.

1.2.  Networks Are Already Sharing Network Properties with Hosts

   To optimally deliver connectivity services, networks also advertize a
   set of information to connected hosts such as:

   Link Maximum Transmission Unit (MTU):  For example, the 3GPP
      [TS-23.501] specifies that "the link MTU size for IPv4 is sent to
      the UE by including it in the PCO (see TS 24.501).  The link MTU
      size for IPv6 is sent to the UE by including it in the IPv6 Router
      Advertisement message (see RFC 4861)".

      Section 2.10 of [RFC7066] indicates that a cellular host should
      honor the MTU option in the Router Advertisement (Section 4.6.4 of
      [RFC4861]) given that the 3GPP system architecture uses extensive
      tunneling in its packet core network below the 3GPP link, and this
      may lead to packet fragmentation issues.

   Prefixes of Network Address and Protocol Translation from IPv6
   clients to IPv4 servers (NAT64) [RFC8781]:  This option is useful to
      enable local DNSSEC validation, support networks with no DNS64,
      support IPv4 address literals on an IPv6-only host, etc.

   Encrypted DNS option [RFC9463]:  This option is used to discover
      encrypted DNS resolvers of a local network.

1.3.  What's In?

   [I-D.rwbr-tsvwg-signaling-use-cases] discusses some use cases where
   it is beneficial to share policies with the hosts. *Given that all
   IPv6 hosts and networks are required to support Neighbor Discovery
   [RFC4861]*, this document specifies a Neighbor Discovery option to be
   used in Router Advertisements (RAs) to communicate these policies to
   hosts.  For address family parity, a DHCP option [RFC2132] is also
   defined for IPv4.

   These options are called: Network Rate-Limit Policy (NRLP).

   This document uses the host/network metadata specified in Section 5.1
   of [I-D.rwbr-sconepro-flow-metadata].

   In order to ensure consistent design for both IPv4 and IPv6
   attachment circuits, Section 3 groups the set of NRLP parameters that
   are returned independent of the address family.  This blob can be
   leveraged in networks where DHCP is not used and ease the mapping
   with specific protocols used in these networks.  For example, a PCO
   NRLP IE can be defined in 3GPP.

   Whether host-to-network, network-to-host, or both policies are
   returning an NRLP is deployment specific.  All these combinations are
   supported in this document.

   Also, the design supports returning one more NRLP instances for a
   given traffic direction.

1.4.  Design Motivation & Rationale

   The main motivations for the use of ND for such a discovery are
   listed in Section 3 of [RFC8781]:

   *  Fate sharing

   *  Atomic configuration

   *  Updatability: change the policy at any time.

   *  Deployability

   The solution specified in the document is designed to *ease
   integration with network managment tools* that are used to manage and
   expose policies.  It does so by leveraging the policy structure
   defined in [I-D.ietf-opsawg-ntw-attachment-circuit].

   The solution defined in this document:

   *  *Does not require any data plane change*.

   *  *Supports cascaded environments* where multiple levels to enforce
      rate limiting polices is required (e.g., WAN and LAN).

   *  *Supports signaling policies bound to one or both traffic
      directions*.

   Compared to a proxy or an encapsulation-based proposal (e.g.,
   [I-D.ihlar-masque-sconepro-mediabitrate]), the solution defined in
   this document:

   *  *Does not impact the MTU tweaking*: No packet overhead is
      required.

   *  *Does not suffer from side effects of multi-layer encryption
      schemes* on the packet processing and overall performance of
      involved network nodes.

   *  *Does not suffer from nested congestion control*.

   *  *Does not suffer from the complications of IP address sharing
      [RFC6269]*. Such issues are likely to be experienced for proxy-
      based solutions that multiplex internal connections using one or
      more external IP addresses.

   *  *Requires a minor change to the network*: upgrade PE nodes to
      support a new ND option.  Note that all IPv6 hosts and networks
      are required to support Neighbor Discovery [RFC4861].

1.5.  What's Out?

   This document does not make any assumption about the type of the
   network (fixed, cellular, etc.) that terminates an attachment
   circuit.

   Likewise, the document does not make any assumption about the
   services or applications that are delivered over an attachment
   circuit.  Whether one or multiple services are bound to the same
   attachment circuit is deployment specific.

   This document does not specify how a receiving host uses the
   discovered policy.  Readers should refer, e.g., to
   [I-D.rwbr-tsvwg-signaling-use-cases] for some examples.

1.6.  Sample Deployment Cases

   Some deployment use cases for NRLP are provided below:

   *  A network may advertize an NRLP when it is overloaded, including
      when it is under attack.  The rate limit policy is basically a
      reactive policy that is meant to adjust the behavior of connected
      hosts to better control the load during these exceptional events.

   *  Discovery of rate limit policy applied on attachment circuits
      (peering links, CE-PE links, etc.).

   *  A user may configure policies on the CPE such as securing some
      resources to a specific internal host used for gaming or video
      streaming.  The CPE can use the NRLP option to share these rate
      limit policies to connected hosts to adjust their forwarding
      behavior.

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   This document uses the terms defined in Section 2 of
   [I-D.ietf-opsawg-ntw-attachment-circuit].

   Also, this document makes use fo the following terms:

   Reactive policy:  Treatment given to a flow when an exceptional event
      occurs, such as diminished throughput to the host caused by radio
      interference or weak radio signal, congestion on the network
      caused by other users or other applications on the same host.

   Intentional policy:  Configured bandwidth, pps, or similar throughput
      constraints applied to a flow, application, host, or subscriber.

3.  NRLP Blob

   This section defines the set of attributes that are included in an
   NRLP blob:

   D:  1-bit flag which indicates the direction on which to apply the
      enclosed policy.

      When set to "1", this flag indicates that this policy is for
      network-to-host direction.

      When set to "0", this flag indicates that this policy is for host-
      to-network direction.

   E:  When set to "1", this flag indicates the presence of Excess
      Information Rate (EIR).

      When set to "0", this flag indicates that EIR is not present.

   P:  When set to "1", this flag indicates the presence of Peak
      Information Rate (PIR).

      When set to "0", this flag indicates that PIR is not present.

   U:  Unassigned bit.

   Scope:  4-bit field which specifies whether the policy is per host,
      per subscriber, etc.

      The following values are supported:

      *  "0": Subscriber

      *  "1": Host

      *  2-15: Unassigned values.

   TC:  8-bit field which specifies a traffic category to which this
      policy applies.

      The following values are supported:

      *  "0": All traffic.  This is the default value.

      *  "1": Streaming

      *  "2": Realtime

      *  "3": Bulk trafic

      *  4-255: Unassigned values

   Committed Information Rate (CIR) (Mbps):  Specifies the maximum
      number of bits that a network can receive or send during one
      second over an attachment circuit for a traffic category.

      If set to 0, this indicates to the host that an alternate path (if
      any) should be preferred over this one.

      See Section 5.1 of [I-D.rwbr-sconepro-flow-metadata].

      This parameter is mandatory.

   Committed Burst Size (CBS) (bytes):  Specifies the maximum burst size
      that can be transmitted at CIR.

      MUST be greated than zero.

      This parameter is mandatory.

   Excess Information Rate (EIR) (Mbps):  MUST be present only if the E
      flag is set to '1'.

      Specifies the maximum number of bits that a network can receive or
      send during one second over an attachment circuit for a traffic
      category that is out of profile.

      See Section 5.1 of [I-D.rwbr-sconepro-flow-metadata].

      This parameter is optional.

   Excess Burst Size (EBS) (bytes):  MUST be present only if EIR is also
      present.

      Indicates that maximum excess burst size that is allowed while not
      complying with the CIR.

      MUST be greater than zero, if present.

      This parameter is optional.

   Peak Information Rate (PIR) (Mbps):  MUST be present only if P flag
      is set to '1'.

      Traffic that exceeds the CIR and the CBS is metered to the PIR.

      See Section 5.1 of [I-D.rwbr-sconepro-flow-metadata].

      This parameter is optional.

   Peak Burst Size (PBS) (bytes):  MUST be present only if PIR is also
      present.

      Specifies the maximum burst size that can be transmitted at PIR.

      MUST be greater than zero, if present.

   The reader should refer to [RFC2697], [RFC2698], and [RFC4115] for
   examples of how various combinations of CIR/CBS/EIR/EBS/PIR/PBS are
   used for policing.  Typically:

   *  A Single-Rate, Three-Color Marker [RFC2697] uses CIR, CBS, and
      EBS.

   *  A Dual-Rate, Three-Color Marker [RFC2698] uses CIR, CBS, PIR, and
      PBS.

4.  IPv6 RA NRLP Option

4.1.  Option Format

   The format of the IPv6 RA NRLP option, with only mandatory fields
   included, is illustrated in Figure 2.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Length    |D|E|P|U| Scope |      TC       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Committed Information Rate (CIR)               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Committed Burst Size (CBS)                   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 2: NRLP Option Format with Mandatory Fields

   The format of the IPv6 RA NRLP option, with optional fields included,
   is illustrated in Figure 2.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     Length    |D|E|P|U| Scope |      TC       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                Committed Information Rate (CIR)               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Committed Burst Size (CBS)                   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               Excess Information Rate (EIR) (Optional)        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Excess Burst Size (EBS) (Optional)           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               Peak Information Rate (PIR) (Optional)          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Peak Burst Size (PBS) (Optional)             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

             Figure 3: NRLP Option Format with Optional Fields

   The fields of the option shown in Figure 3 are as follows:

   Type:  8-bit identifier of the NRLP option as assigned by IANA
      (TBD1).

   Length:  8-bit unsigned integer.  The length of the option (including
      the Type and Length fields) is in units of 8 octets.

   D:  See Section 3.

   E:  See Section 3.

   P:  See Section 3.

   U:  Unassigned bit.

   Scope:  See Section 3.

   TC:  See Section 3.

   Committed Information Rate (CIR) (Mbps):  See Section 3.

   Committed Burst Size (CBS) (bytes):  See Section 3.

   Excess Information Rate (EIR) (Mbps):  See Section 3.  This is an
      optional field.

   Excess Burst Size (EBS) (bytes):  See Section 3.  This is an optional
      field.

   Peak Information Rate (PIR) (Mbps):  See Section 3.  This is an
      optional field.

   Peak Burst Size (PBS) (bytes):  See Section 3.  This is an optional
      field.

4.2.  IPv6 Host Behavior

   The procedure for rate-limit configuration is the same as it is with
   any other Neighbor Discovery option [RFC4861].

   The host MUST be prepared to receive multiple NRLP options in RAs;
   each with distinct scope and/or application group.

   If the host receives multiple NRLP options with overlapping scope/TC,
   the host MUST silently discard all these options.

   If the receiving host is a CE (e.g., mobile CE or mobile handset with
   tethering), the following behavior applies:

   *  If an RA NRLP is advertised from the network, and absent local
      rate limit policies, the device should send RAs to the downstream
      attached LAN devices with the same NRLP values received from the
      network.

   *  If local rate-limit policies are provided to the device, the
      device may change the scope or values received from the network to
      accommodate these policies.  The device may decide to not relay
      received RAs to internal nodes if local policies were already
      advertized using RAs and those policies are consistent with the
      network policies.

   Applications running over a host can learn the bitrates associated
   with a network attachment by invoking a dedicated API.  The exact
   details of the API is OS-specific and, thus, out of scope of this
   document.

5.  DHCP NRLP Option

5.1.  Option Format

   The format of the DHCP NRLP option is illustrated in Figure 4.

                 0                   1
                 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                | OPTION_V4_NRLP|     Length    |
                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                ~      NRLP Instance Data #1    ~
                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   ---
                .              ...              .    |
                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ optional
                ~      NRLP Instance Data #n    ~    |
                +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   ---

                     Figure 4: NRLP DHCP Option Format

   The fields of the option shown in Figure 4 are as follows:

   Code:  OPTION_V4_NRLP (TBD2).

   Length:  Indicates the length of the enclosed data in octets.

   NRLP Instance Data:  Includes a network rate-limit policy.  The
      format of this field with only mandatory parameters is shown in
      Figure 5.

      When several NRLPs are to be included, the "NRLP Instance Data"
      field is repeated.

                      0                   1
                      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |   NRLP Instance Data Length   |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |D|E|P|U| Scope |      TC       |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |  Committed Information Rate   |
                     |              (CIR)            |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     |  Committed Burst Size (CBS)   |
                     |                               |
                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

         Figure 5: NRLP Instance Data Format with Mandatory Fields

   The format of this field, with optional parameters included, is shown
   in Figure 5.

                    0                   1
                    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                   |   NRLP Instance Data Length   |
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                   |D|E|P|U| Scope |      TC       |
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                   |  Committed Information Rate   |
                   |              (CIR)            |
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                   |  Committed Burst Size (CBS)   |
                   |                               |
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---
                   |  Excess Information Rate      |  |
                   |             (EIR)             |  O
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  P
                   |    Excess Burst Size (CBS)    |  T
                   |                               |  I
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  O
                   |    Peak Information Rate      |  N
                   |             (PIR)             |  A
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  L
                   |      Peak Burst Size (PBS)    |  |
                   |                               |  |
                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ---

     Figure 6: NRLP Instance Data Format with Optional Fields Included

   The fields shown in Figure 6 are as follows:

   NRLP Instance Data Length:  Length of all following data in octets.
      This field is set to '8' when only the nominal bitrate is provided
      for an NLRP instance.

   D:  See Section 3.

   E:  See Section 3.

   P:  See Section 3.

   U:  Unassigned bit.

   Scope:  See Section 3.

   TC:  See Section 3.

   Committed Information Rate (CIR) (Mbps):  See Section 3.

   Committed Burst Size (CBS) (bytes):  See Section 3.

   Excess Information Rate (EIR) (Mbps):  See Section 3.  This is an
      optional field.

   Excess Burst Size (EBS) (bytes):  See Section 3.  This is an optional
      field.

   Peak Information Rate (PIR) (Mbps):  See Section 3.  This is an
      optional field.

   Peak Burst Size (PBS) (bytes):  See Section 3.  This is an optional
      field.

   OPTION_V4_NRLP is a concatenation-requiring option.  As such, the
   mechanism specified in [RFC3396] MUST be used if OPTION_V4_NRLP
   exceeds the maximum DHCP option size of 255 octets.

5.2.  DHCPv4 Client Behavior

   To discover a network rate-limit policy, the DHCP client includes
   OPTION_V4_NRLP in a Parameter Request List option [RFC2132].

   The DHCP client MUST be prepared to receive multiple "NRLP Instance
   Data" field entries in the OPTION_V4_NRLP option; each instance is to
   be treated as a separate network rate-limit policy.

6.  Operational Considerations

   NRLP senders should be configured with instructions about the type of
   network rate-limit policies to be shared with requesting hosts.
   These types can be provided using mechanisms such as
   [I-D.ietf-opsawg-ntw-attachment-circuit].

   In contexts where the bitrate policies are known during the
   establishment of the underlying bearer (e.g., GBR PDU Sessions),
   sending NRLP signals over the attachment circuit may be redundant and
   should thus be disabled.

   In contexts where the (average) bitrate policies provided during the
   establishment of a bearer cannot be refreshed to echo network-
   specific conditions (e.g., overload) using bearer-specific
   mechanisms, sending NRLP signals over the attachment circuit would
   allow control the load at the source.

   When both bearer-specific policies and NRLP signals are communicated
   to a host, the NRLP signals takes precedence.

   Rate-limit policies enforced at the network are assumed to be
   consistent with the local jurisdictions.

7.  Security Considerations

7.1.  ND

   As discussed in [RFC8781], because RAs are required in all IPv6
   configuration scenarios, RAs must already be secured, e.g., by
   deploying an RA-Guard [RFC6105].  Providing all configuration in RAs
   reduces the attack surface to be targeted by malicious attackers
   trying to provide hosts with invalid configuration, as compared to
   distributing the configuration through multiple different mechanisms
   that need to be secured independently.

   RAs are already used in mobile networks to advertize the link MTU.
   The same security considerartions for MTU discovery apply for the
   NRLP discover.

   An attacker who has access to the RAs exchanged over an attachment
   circuit may:

   *  Decrease the bitrate: This may lower the perceived QoS if the host
      aggressively lowers its transmission rate.

   *  Increase the bitrate value: The attachment circuit will be
      overloaded, but still the rate-limit at the network will discard
      excess traffic.

   *  Drop RAs: This is similar to the current operations, where no NRLP
      RA is shared.

   *  Inject fake RAs: The implications are similar to the impacts of
      tweaking the values of a legitimate RA.

7.2.  DHCP

   An attacker who has access to the DHCP exchanged over an attachment
   circuit may do a lot of harm (e.g., prevent access to the network).

   The following mechanisms may be considered to mitigate spoofed or
   modified DHCP responses:

   DHCPv6-Shield [RFC7610]:  The network access node (e.g., a border
      router, a CPE, an Access Point (AP)) discards DHCP response
      messages received from any local endpoint.

   Source Address Validation Improvement (SAVI) solution for DHCP
   [RFC7513]:  The network access node filters packets with forged
      source IP addresses.

   The above mechanisms would ensure that the endpoint receives the
   correct NRLP information, but these mechanisms cannot provide any
   information about the DHCP server or the entity hosting the DHCP
   server.

8.  IANA Considerations

8.1.  Neighbor Discovery Option

   This document requests IANA to assign the following new IPv6 Neighbor
   Discovery Option type in the "IPv6 Neighbor Discovery Option Formats"
   subregistry under the "Internet Control Message Protocol version 6
   (ICMPv6) Parameters" registry maintained at [IANA-ND].

                  +======+=============+===============+
                  | Type | Description | Reference     |
                  +======+=============+===============+
                  | TBD1 | NRLP Option | This-Document |
                  +------+-------------+---------------+

                     Table 1: Neighbor Discovery NRLP
                                  Option

8.2.  DHCP Option

   This document requests IANA to assign the following new DHCP Option
   Code in the "BOOTP Vendor Extensions and DHCP Options" registry
   maintained at [IANA-BOOTP].

   +======+================+=============+=============+===============+
   | Tag  | Name           | Data Length | Meaning     | Reference     |
   +======+================+=============+=============+===============+
   | TBD2 | OPTION_V4_NRLP | N           | NRLP        | This-Document |
   |      |                |             | Option      |               |
   +------+----------------+-------------+-------------+---------------+

                         Table 2: DHCP NRLP Option

9.  References

9.1.  Normative References

   [I-D.rwbr-sconepro-flow-metadata]
              Rajagopalan, S., Wing, D., Boucadair, M., and T. Reddy.K,
              "Flow Metadata for Collaborative Host/Network Signaling",
              Work in Progress, Internet-Draft, draft-rwbr-sconepro-
              flow-metadata-00, 4 March 2024,
              <https://datatracker.ietf.org/doc/html/draft-rwbr-
              sconepro-flow-metadata-00>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC2132]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", RFC 2132, DOI 10.17487/RFC2132, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2132>.

   [RFC3396]  Lemon, T. and S. Cheshire, "Encoding Long Options in the
              Dynamic Host Configuration Protocol (DHCPv4)", RFC 3396,
              DOI 10.17487/RFC3396, November 2002,
              <https://www.rfc-editor.org/rfc/rfc3396>.

   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", RFC 4861,
              DOI 10.17487/RFC4861, September 2007,
              <https://www.rfc-editor.org/rfc/rfc4861>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

9.2.  Informative References

   [I-D.ietf-opsawg-ntw-attachment-circuit]
              Boucadair, M., Roberts, R., de Dios, O. G., Barguil, S.,
              and B. Wu, "A Network YANG Data Model for Attachment
              Circuits", Work in Progress, Internet-Draft, draft-ietf-
              opsawg-ntw-attachment-circuit-05, 9 February 2024,
              <https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-
              ntw-attachment-circuit-05>.

   [I-D.ihlar-masque-sconepro-mediabitrate]
              Ihlar, M. and M. KÃ¼hlewind, "MASQUE extension for
              signaling media bitrate", Work in Progress, Internet-
              Draft, draft-ihlar-masque-sconepro-mediabitrate-00, 9
              February 2024, <https://datatracker.ietf.org/doc/html/
              draft-ihlar-masque-sconepro-mediabitrate-00>.

   [I-D.rwbr-tsvwg-signaling-use-cases]
              Rajagopalan, S., Wing, D., Boucadair, M., and T. Reddy.K,
              "Host to Network Signaling Use Cases for Collaborative
              Traffic Differentiation", Work in Progress, Internet-
              Draft, draft-rwbr-tsvwg-signaling-use-cases-02, 17 March
              2024, <https://datatracker.ietf.org/doc/html/draft-rwbr-
              tsvwg-signaling-use-cases-02>.

   [IANA-BOOTP]
              IANA, "BOOTP Vendor Extensions and DHCP Options",
              <https://www.iana.org/assignments/bootp-dhcp-parameters/>.

   [IANA-ND]  IANA, "IPv6 Neighbor Discovery Option Formats",
              <https://www.iana.org/assignments/icmpv6-parameters/>.

   [RFC2697]  Heinanen, J. and R. Guerin, "A Single Rate Three Color
              Marker", RFC 2697, DOI 10.17487/RFC2697, September 1999,
              <https://www.rfc-editor.org/rfc/rfc2697>.

   [RFC2698]  Heinanen, J. and R. Guerin, "A Two Rate Three Color
              Marker", RFC 2698, DOI 10.17487/RFC2698, September 1999,
              <https://www.rfc-editor.org/rfc/rfc2698>.

   [RFC4115]  Aboul-Magd, O. and S. Rabie, "A Differentiated Service
              Two-Rate, Three-Color Marker with Efficient Handling of
              in-Profile Traffic", RFC 4115, DOI 10.17487/RFC4115, July
              2005, <https://www.rfc-editor.org/rfc/rfc4115>.

   [RFC6105]  Levy-Abegnoli, E., Van de Velde, G., Popoviciu, C., and J.
              Mohacsi, "IPv6 Router Advertisement Guard", RFC 6105,
              DOI 10.17487/RFC6105, February 2011,
              <https://www.rfc-editor.org/rfc/rfc6105>.

   [RFC6269]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
              P. Roberts, "Issues with IP Address Sharing", RFC 6269,
              DOI 10.17487/RFC6269, June 2011,
              <https://www.rfc-editor.org/rfc/rfc6269>.

   [RFC7066]  Korhonen, J., Ed., Arkko, J., Ed., Savolainen, T., and S.
              Krishnan, "IPv6 for Third Generation Partnership Project
              (3GPP) Cellular Hosts", RFC 7066, DOI 10.17487/RFC7066,
              November 2013, <https://www.rfc-editor.org/rfc/rfc7066>.

   [RFC7513]  Bi, J., Wu, J., Yao, G., and F. Baker, "Source Address
              Validation Improvement (SAVI) Solution for DHCP",
              RFC 7513, DOI 10.17487/RFC7513, May 2015,
              <https://www.rfc-editor.org/rfc/rfc7513>.

   [RFC7610]  Gont, F., Liu, W., and G. Van de Velde, "DHCPv6-Shield:
              Protecting against Rogue DHCPv6 Servers", BCP 199,
              RFC 7610, DOI 10.17487/RFC7610, August 2015,
              <https://www.rfc-editor.org/rfc/rfc7610>.

   [RFC8781]  Colitti, L. and J. Linkova, "Discovering PREF64 in Router
              Advertisements", RFC 8781, DOI 10.17487/RFC8781, April
              2020, <https://www.rfc-editor.org/rfc/rfc8781>.

   [RFC9463]  Boucadair, M., Ed., Reddy.K, T., Ed., Wing, D., Cook, N.,
              and T. Jensen, "DHCP and Router Advertisement Options for
              the Discovery of Network-designated Resolvers (DNR)",
              RFC 9463, DOI 10.17487/RFC9463, November 2023,
              <https://www.rfc-editor.org/rfc/rfc9463>.

   [TS-23.501]
              3GPP, "TS 23.501: System architecture for the 5G System
              (5GS)", 2024,
              <https://portal.3gpp.org/desktopmodules/Specifications/
              SpecificationDetails.aspx?specificationId=3144>.

Acknowledgments

   TODO acknowledge.

Authors' Addresses

   Mohamed Boucadair
   Orange
   Email: mohamed.boucadair@orange.com


   Tirumaleswar Reddy
   Nokia
   India
   Email: kondtir@gmail.com


   Dan Wing
   Cloud Software Group Holdings, Inc.
   United States of America
   Email: danwing@gmail.com
